from TwitterAPI import TwitterAPI
import xlwt
from xlwt import Workbook

consumer_key = 'WwINmsz1NuBFsDPjBcjLAoesT'
consumer_secret = 'SJ6ZftwI2i3mcgG9ViPnxdTsLtxjjHJG6A7DvXvWDwShu0dSkX'
access_token_key = '1041324662-nuZDn6Cf4isjZDRCrWcPMf6v26NpDtaMfn3NyMo'
access_token_secret = 'AQu0C6axHKpWwIqFY7cOdrwFRtGD54hWxGrTZGTQ5Xpum'

api = TwitterAPI(consumer_key, consumer_secret, access_token_key, access_token_secret)

tweetId = [                                                         """ID's de 100 tweets de @yolopido"""
1149773471049760773,               
1149769691075948544,
1149416910242701312,
1149410828984225794,
1149322236207292417,
1149031876323135488,
1148971455960485888,
1148684042864386049,
1148670208443322368,
1146863287046418432,
1146811375907459072,
1146514750861402115,
1146152895278211072,
1146133481342296064,
1146080168106242048,
1145793987309187073,
1145775117831684097,
1145721761411022848,
1144670838240743427,
1144262649045225474,
1143614129816649729,
1143596512758439938,
1143535364545622017,
1141081673410514944,
1140642291377479680,
1139639706373775360,
1139573495392866306,
1139290163132141568,
1139180422552854531,
1138899524859158531,
1138842686264422400,
1138480303104827394,
1138190433316737024,
1138114984603541504,
1137466893978230785,
1137421679838322700,
1137350115621036032,
1137103244487004160,
1136731538522071040,
1136626095317540866,
1136377838939119622,
1136352558656753664,
1136268727174012928,
1136016137697792000,
1136002709474172929,
1135993010074869767,
1135939909330579458,
1135630791692734464,
1135575172226977792,
1135292587231911939,
1135215817480638464,
1134884949490831360,
1134854690536120320,
1134808217333186560,
1134566584163418114,
1134541091083104261,
1134536594575245312,
1134204201838567424,
1134165318002233344,
1134128043142893569,
1133774036050300928,
1133765739435970560,
1133479387872075777,
1133448481203511296,
1133403877863297029,
1133118267499921408,
1133088040820367360,
1133042747739443201,
1131641992793022465,
1131304326100606976,
1131183447601549313,
1130863443811164162,
1130580281465999362,
1130550077175545857,
1130550076714180608,
1130504127375659015,
1130223165484011520,
1129860757808648193,
1129492395249283073,
1129462985146216452,
1129420226750103553,
1129099901223211014,
1129055223278899200,
1129024582902591488,
1128405958575710211,
1128370935088730112,
1128330525981270021,
1128043559154868229,
1128014650942136322,
1127974518109233152,
1127681171616354304,
1127635870905974785,
1127590313160249344,
1127317796302594048,
1127243284806500352,
1126956411102158848,
1126912832098971654,
1126875333649674240,
1126592206909972482,
1126520526137171970
]

wb = Workbook()
sheet1 = wb.add_sheet('Sheet 1')
sheet1.write(0, 0, 'Tweet')
sheet1.write(0, 1, 'Fecha')
sheet1.write(0, 2, 'Dia')
sheet1.write(0, 3, 'Retweets')
sheet1.write(0, 4, 'Likes')

count = 1
for tweet in tweetId:
    r = api.request('statuses/show/:%d' % tweet)
    for item in r.get_iterator():
        if 'text' in item:
            text = item['text']
            textDate = item['created_at']
            cantRetweet = item['retweet_count']
            cantFav = item['favorite_count']

            if textDate[4:7] == 'May':
                month = '05'
            elif textDate[4:7] == 'Jun':
                month = '06'
            elif textDate[4:7] == 'Jul':
                month = '07'
            date = '2019' + '-' + month + '-' + textDate[8:10]

            sheet1.write(count, 0, text)
            sheet1.write(count, 1, date)
            sheet1.write(count, 2, textDate[0:4])
            sheet1.write(count, 3, cantRetweet)
            sheet1.write(count, 4, cantFav)
    count = count + 1

wb.save('deliveryData.xls')